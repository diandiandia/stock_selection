2025-08-21 11:18:15 - __main__ - INFO - ====== 开始数据获取 ======
2025-08-21 11:18:15 - __main__ - INFO - 正常模式：使用3年数据
2025-08-21 11:18:15 - src.data_storage.data_saver - INFO - init saver, file path: ./data\stock_data.db
2025-08-21 11:18:15 - src.data_storage.data_saver - INFO - read stock_daily data from sqlite, sql command: select * from stock_daily where trade_date >= 20150823 and trade_date <= 20250820
2025-08-21 11:18:22 - __main__ - INFO - 获取数据完成: 20220104至20250819, 共691696条记录, 800支股票
2025-08-21 11:18:22 - __main__ - INFO - ====== 开始计算技术指标 ======
2025-08-21 11:18:51 - __main__ - INFO - 计算技术指标完成: 新增36个特征，总特征数=48
2025-08-21 11:18:51 - __main__ - INFO - 技术指标列表示例: ['CDL_HAMMER', 'CDL_DOJI', 'CDL_MORNINGSTAR', 'CDL_THREEWHITESOLDIERS', 'SAR', 'VWAP', 'StochRSI_K', 'StochRSI_D', 'price_momentum', 'volume_momentum']
2025-08-21 11:18:51 - __main__ - INFO - ====== 开始数据预处理 ======
2025-08-21 11:18:51 - __main__ - INFO - 数据质量检查...
2025-08-21 11:18:51 - src.data_preprocessing.data_preprocessor - INFO - 开始一站式数据准备和模型拟合...
2025-08-21 11:18:51 - src.data_preprocessing.data_preprocessor - INFO - 开始为所有股票准备训练数据...
2025-08-21 11:18:51 - src.data_preprocessing.data_preprocessor - INFO - 步骤1: 创建特征...
2025-08-21 11:18:51 - src.data_preprocessing.data_preprocessor - INFO - 开始创建特征，输入数据形状: (691696, 48)
2025-08-21 11:18:51 - src.data_preprocessing.data_preprocessor - INFO - 数据排序完成，股票数量: 800
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 技术信号创建完成，新增特征数量: 1
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 步骤2: 创建目标变量...
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 开始创建目标变量，预测周期: 1
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 目标变量创建完成，有效样本数: 690896, 均值: 0.0002, 标准差: 0.0261
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 数据概览: 800 只股票, 691696 条记录
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 步骤3: 全局特征选择...
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 开始特征选择...
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 原始特征数量: 42
2025-08-21 11:18:52 - src.data_preprocessing.data_preprocessor - INFO - 缺失值过滤后特征数量: 42 (过滤了 0 个)
2025-08-21 11:18:53 - src.data_preprocessing.data_preprocessor - INFO - 开始多重共线性检测，输入特征数量: 42
2025-08-21 11:18:58 - src.data_preprocessing.data_preprocessor - INFO - 预过滤高相关特征: 13 个 (相关系数>0.9)
2025-08-21 11:28:17 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测完成: 最终选择 23 个特征
2025-08-21 11:28:17 - src.data_preprocessing.data_preprocessor - INFO - 特征数量限制: 从 23 个减少到 23 个
2025-08-21 11:28:17 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测后最终特征数量: 23
2025-08-21 11:28:17 - src.data_preprocessing.data_preprocessor - INFO - 特征选择完成: 原始42 → 缺失值过滤42 → 去多重共线性23
2025-08-21 11:28:17 - src.data_preprocessing.data_preprocessor - INFO - 选择的特征: ['amount', 'amplitude', 'change', 'change_amount', 'turnover', 'MA5', 'MOM', 'ADX', 'MINUS_DI', 'MACD', 'MACD_Hist', 'ATR', 'VOL_MA5', 'OBV', 'CMF', 'CDL_BULLISH_ENGULFING', 'CDL_HAMMER', 'CDL_DOJI', 'CDL_MORNINGSTAR', 'CDL_THREEWHITESOLDIERS', 'StochRSI_K', 'volume_momentum', 'buy_signal_count']
2025-08-21 11:28:17 - src.data_preprocessing.data_preprocessor - INFO - 步骤4: 收集时序数据...
2025-08-21 11:28:42 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 50/800 只股票
2025-08-21 11:29:01 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 100/800 只股票
2025-08-21 11:29:20 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 150/800 只股票
2025-08-21 11:29:39 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 200/800 只股票
2025-08-21 11:30:01 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 250/800 只股票
2025-08-21 11:30:25 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 300/800 只股票
2025-08-21 11:30:47 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 350/800 只股票
2025-08-21 11:31:13 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 400/800 只股票
2025-08-21 11:31:42 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 450/800 只股票
2025-08-21 11:32:24 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 500/800 只股票
2025-08-21 11:33:11 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 550/800 只股票
2025-08-21 11:33:51 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 600/800 只股票
2025-08-21 11:34:45 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 650/800 只股票
2025-08-21 11:35:42 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 700/800 只股票
2025-08-21 11:36:14 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 750/800 只股票
2025-08-21 11:36:35 - src.data_preprocessing.data_preprocessor - INFO - 处理进度: 800/800 只股票
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - 数据准备完成:
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - - 处理股票数: 800/800
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - - 总样本数: 674896
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - - 特征维度: 23
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - - 时间步长: 20
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - 开始模型拟合，计算预处理参数...
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - 训练数据形状: X=(674896, 20, 23), y=(674896,)
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - 重塑后数据形状: (13497920, 23)
2025-08-21 11:36:36 - src.data_preprocessing.data_preprocessor - INFO - 计算缺失值填充值...
2025-08-21 11:36:43 - src.data_preprocessing.data_preprocessor - INFO - 缺失值统计: 总缺失值 0, 平均每特征 0.0
2025-08-21 11:36:43 - src.data_preprocessing.data_preprocessor - INFO - 计算异常值阈值...
2025-08-21 11:36:59 - src.data_preprocessing.data_preprocessor - INFO - 异常值统计: 总异常值 16323884, 平均每特征 709734.1
2025-08-21 11:36:59 - src.data_preprocessing.data_preprocessor - INFO - 开始数据清洗...
2025-08-21 11:37:13 - src.data_preprocessing.data_preprocessor - INFO - 处理目标变量...
2025-08-21 11:37:13 - src.data_preprocessing.data_preprocessor - INFO - 目标变量无需填充，均值: -0.0007
2025-08-21 11:37:13 - src.data_preprocessing.data_preprocessor - INFO - 计算目标变量异常值阈值...
2025-08-21 11:37:13 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值范围: [-0.0815, 0.0800]
2025-08-21 11:37:13 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值处理: 裁剪 11507/674896 个异常值
2025-08-21 11:37:13 - src.data_preprocessing.data_preprocessor - INFO - 拟合特征缩放器...
2025-08-21 11:37:23 - src.data_preprocessing.data_preprocessor - INFO - 拟合目标变量缩放器...
2025-08-21 11:37:23 - src.data_preprocessing.data_preprocessor - INFO - 模型拟合完成，所有预处理参数已计算
2025-08-21 11:37:57 - src.data_preprocessing.data_preprocessor - INFO - 一站式处理完成: 获得674896个样本，674896支股票
2025-08-21 11:37:57 - src.data_preprocessing.data_preprocessor - INFO - 最终数据维度: X=(674896, 20, 23), y=(674896,)
2025-08-21 11:37:57 - __main__ - INFO - 数据预处理完成: 获得674896个样本，674896支股票
2025-08-21 11:37:57 - __main__ - INFO - 时序数据维度: X_sequence=(674896, 20, 23), y=(674896,)
2025-08-21 11:37:57 - __main__ - INFO - ====== 创建训练测试集 ======
2025-08-21 11:37:57 - src.data_preprocessing.data_preprocessor - INFO - Train/test split completed: 539916 train, 134980 test samples
2025-08-21 11:37:57 - __main__ - INFO - 数据分割完成:
2025-08-21 11:37:57 - __main__ - INFO -   训练集: 539916个样本 (80.0%)
2025-08-21 11:37:57 - __main__ - INFO -   测试集: 134980个样本 (20.0%)
2025-08-21 11:37:57 - __main__ - INFO - ====== 开始训练LSTM+LightGBM混合模型 ======
2025-08-21 11:37:57 - src.model.lstm_lgbm_predictor - INFO - 开始混合模型训练，样本数量: 539916
2025-08-21 11:37:57 - src.model.lstm_lgbm_predictor - INFO - 输入序列形状: (539916, 20, 23)
2025-08-21 11:38:03 - src.model.lstm_lgbm_predictor - INFO - 训练LightGBM模型...
2025-08-21 11:38:12 - src.model.lstm_lgbm_predictor - INFO - 训练LSTM模型...
2025-08-21 11:54:52 - __main__ - INFO - ====== 开始数据获取 ======
2025-08-21 11:54:52 - __main__ - INFO - 正常模式：使用10年数据
2025-08-21 11:54:52 - src.data_storage.data_saver - INFO - init saver, file path: ./data\stock_data.db
2025-08-21 11:54:52 - src.data_storage.data_saver - INFO - read stock_daily data from sqlite, sql command: select * from stock_daily where trade_date >= 20150823 and trade_date <= 20250820
2025-08-21 11:54:56 - __main__ - INFO - 获取数据完成: 20220104至20250819, 共691696条记录, 800支股票
2025-08-21 11:54:56 - __main__ - INFO - ====== 开始计算技术指标 ======
2025-08-21 11:54:57 - __main__ - ERROR - 系统执行失败: input array type is not double
Traceback (most recent call last):
  File "d:\Projects\stock_selection\main.py", line 52, in main
    df_with_indicators = ti.calculate_all_indicators()
  File "d:\Projects\stock_selection\src\data_preprocessing\technical_indicators.py", line 256, in calculate_all_indicators
    results = list(executor.map(compute_group, groups))
  File "C:\Users\phigent01\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\_base.py", line 609, in result_iterator
    yield fs.pop().result()
  File "C:\Users\phigent01\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\_base.py", line 439, in result
    return self.__get_result()
  File "C:\Users\phigent01\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\_base.py", line 391, in __get_result
    raise self._exception
  File "C:\Users\phigent01\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "d:\Projects\stock_selection\src\data_preprocessing\technical_indicators.py", line 228, in compute_group
    indicators.update(ti.calculate_moving_averages(close, ma_periods, use_ema))
  File "d:\Projects\stock_selection\src\data_preprocessing\technical_indicators.py", line 38, in calculate_moving_averages
    return {f'MA{p}': talib.SMA(close, timeperiod=p) for p in periods}
  File "d:\Projects\stock_selection\src\data_preprocessing\technical_indicators.py", line 38, in <dictcomp>
    return {f'MA{p}': talib.SMA(close, timeperiod=p) for p in periods}
  File "D:\Projects\stock_selection\.venv\lib\site-packages\talib\__init__.py", line 80, in wrapper
    result = func(*_args, **_kwds)
  File "talib/_func.pxi", line 4638, in talib._ta_lib.SMA
  File "talib/_func.pxi", line 22, in talib._ta_lib.check_array
Exception: input array type is not double
2025-08-21 12:00:58 - __main__ - INFO - ====== 开始数据获取 ======
2025-08-21 12:00:58 - __main__ - INFO - 正常模式：使用10年数据
2025-08-21 12:00:58 - src.data_storage.data_saver - INFO - init saver, file path: ./data\stock_data.db
2025-08-21 12:00:58 - src.data_storage.data_saver - INFO - read stock_daily data from sqlite, sql command: select * from stock_daily where trade_date >= 20150823 and trade_date <= 20250820
2025-08-21 12:01:00 - __main__ - INFO - 获取数据完成: 20220104至20250819, 共691696条记录, 800支股票
2025-08-21 12:01:00 - __main__ - INFO - ====== 开始计算技术指标 ======
2025-08-21 12:01:10 - __main__ - INFO - 计算技术指标完成: 新增36个特征，总特征数=48
2025-08-21 12:01:10 - __main__ - INFO - 技术指标列表示例: ['trade_date', 'ts_code', 'open', 'close', 'high', 'low', 'volume', 'amount', 'amplitude', 'change', 'change_amount', 'turnover', 'MA5', 'MA10', 'MA20', 'RSI6', 'RSI12', 'MOM', 'KDJ_K', 'KDJ_D', 'KDJ_J', 'CCI', 'ADX', 'PLUS_DI', 'MINUS_DI', 'MACD', 'MACD_Signal', 'MACD_Hist', 'BB_upper', 'BB_middle', 'BB_lower', 'ATR', 'VOL_MA5', 'VOL_MA10', 'OBV', 'CMF', 'MFI', 'CDL_BULLISH_ENGULFING', 'CDL_HAMMER', 'CDL_DOJI', 'CDL_MORNINGSTAR', 'CDL_THREEWHITESOLDIERS', 'SAR', 'VWAP', 'StochRSI_K', 'StochRSI_D', 'price_momentum', 'volume_momentum']
2025-08-21 12:01:10 - __main__ - INFO - ====== 开始数据预处理 ======
2025-08-21 12:01:10 - __main__ - INFO - 数据质量检查...
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 开始一站式数据准备和模型拟合...
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 步骤1: 创建特征...
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 开始创建特征，输入数据形状: (691696, 48)
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 数据排序完成，股票数量: 800
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 技术信号创建完成，新增特征数量: 1
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 步骤2: 创建目标变量...
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 开始创建目标变量，预测周期: 1
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 目标变量创建完成，有效样本数: 690896, 均值: 0.0002, 标准差: 0.0261
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 数据质量检查...
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - WARNING - 发现800个空值，将在预处理中处理
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 步骤3: 全局特征选择...
2025-08-21 12:01:10 - src.data_preprocessing.data_preprocessor - INFO - 开始特征选择...
2025-08-21 12:01:11 - src.data_preprocessing.data_preprocessor - INFO - 原始特征数量: 42
2025-08-21 12:01:11 - src.data_preprocessing.data_preprocessor - INFO - 缺失值过滤后特征数量: 42 (过滤了 0 个)
2025-08-21 12:01:11 - src.data_preprocessing.data_preprocessor - INFO - 开始多重共线性检测，输入特征数量: 42
2025-08-21 12:01:11 - src.data_preprocessing.data_preprocessor - INFO - 预过滤高相关特征: 19 个 (相关系数>0.8)
2025-08-21 12:01:13 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测完成: 最终选择 20 个特征
2025-08-21 12:01:13 - src.data_preprocessing.data_preprocessor - INFO - 特征数量限制: 从 20 个减少到 20 个
2025-08-21 12:01:13 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测后最终特征数量: 20
2025-08-21 12:01:13 - src.data_preprocessing.data_preprocessor - INFO - 特征选择完成: 原始42 → 缺失值过滤42 → 去多重共线性20
2025-08-21 12:01:13 - src.data_preprocessing.data_preprocessor - INFO - 步骤4: 收集时序数据...
2025-08-21 12:08:04 - src.data_preprocessing.data_preprocessor - INFO - 数据准备完成:
2025-08-21 12:08:04 - src.data_preprocessing.data_preprocessor - INFO - - 处理股票数: 800/800
2025-08-21 12:08:04 - src.data_preprocessing.data_preprocessor - INFO - - 总样本数: 674896
2025-08-21 12:08:04 - src.data_preprocessing.data_preprocessor - INFO - - 特征维度: 20
2025-08-21 12:08:04 - src.data_preprocessing.data_preprocessor - INFO - - 时间步长: 20
2025-08-21 12:08:06 - src.data_preprocessing.data_preprocessor - INFO - 开始模型拟合，计算预处理参数...
2025-08-21 12:08:06 - src.data_preprocessing.data_preprocessor - INFO - 开始拟合预处理器...
2025-08-21 12:08:06 - src.data_preprocessing.data_preprocessor - INFO - 训练数据形状: X=(674896, 20, 20), y=(674896,)
2025-08-21 12:08:08 - src.data_preprocessing.data_preprocessor - INFO - 计算缺失值填充值...
2025-08-21 12:08:15 - src.data_preprocessing.data_preprocessor - INFO - 缺失值统计: 总缺失值 0, 平均每特征 0.0
2025-08-21 12:08:15 - src.data_preprocessing.data_preprocessor - INFO - 计算异常值阈值...
2025-08-21 12:08:20 - src.data_preprocessing.data_preprocessor - INFO - 异常值统计: 总异常值 4133110, 平均每特征 206655.5
2025-08-21 12:08:20 - src.data_preprocessing.data_preprocessor - INFO - 开始数据清洗...
2025-08-21 12:08:25 - src.data_preprocessing.data_preprocessor - INFO - 处理目标变量...
2025-08-21 12:08:25 - src.data_preprocessing.data_preprocessor - INFO - 目标变量无需填充，均值: -0.0007
2025-08-21 12:08:25 - src.data_preprocessing.data_preprocessor - INFO - 计算目标变量异常值阈值...
2025-08-21 12:08:25 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值范围: [-0.0779, 0.0785]
2025-08-21 12:08:25 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值处理: 裁剪 12332/674896 个异常值
2025-08-21 12:08:25 - src.data_preprocessing.data_preprocessor - INFO - 拟合特征缩放器...
2025-08-21 12:08:28 - src.data_preprocessing.data_preprocessor - INFO - 拟合目标变量缩放器...
2025-08-21 12:08:29 - src.data_preprocessing.data_preprocessor - INFO - 模型拟合完成，所有预处理参数已计算
2025-08-21 12:08:29 - src.data_preprocessing.data_preprocessor - INFO - 转换数据...
2025-08-21 12:08:38 - src.data_preprocessing.data_preprocessor - INFO - 一站式处理完成: 获得674896个样本，674896支股票
2025-08-21 12:08:38 - src.data_preprocessing.data_preprocessor - INFO - 最终数据维度: X= (674896, 20, 20), y=(674896,)
2025-08-21 12:08:40 - __main__ - INFO - 数据预处理完成: 获得674896个样本，674896支股票
2025-08-21 12:08:40 - __main__ - INFO - 时序数据维度: X_sequence=(674896, 20, 20), y=(674896,)
2025-08-21 12:08:40 - __main__ - INFO - ====== 创建训练测试集 ======
2025-08-21 12:08:40 - src.data_preprocessing.data_preprocessor - INFO - Train/test split completed: 539916 train, 134980 test samples
2025-08-21 12:08:40 - __main__ - INFO - 数据分割完成:
2025-08-21 12:08:40 - __main__ - INFO -   训练集: 539916个样本 (80.0%)
2025-08-21 12:08:40 - __main__ - INFO -   测试集: 134980个样本 (20.0%)
2025-08-21 12:08:40 - __main__ - INFO - ====== 开始训练LSTM+LightGBM混合模型 ======
2025-08-21 12:08:40 - src.model.lstm_lgbm_predictor - INFO - 开始混合模型训练，样本数量: 539916
2025-08-21 12:08:40 - src.model.lstm_lgbm_predictor - INFO - 输入序列形状: (539916, 20, 20)
2025-08-21 12:08:45 - src.model.lstm_lgbm_predictor - INFO - 训练LightGBM模型...
2025-08-21 12:08:52 - src.model.lstm_lgbm_predictor - INFO - 可用内存: 4.29 GB
2025-08-21 12:08:52 - src.model.lstm_lgbm_predictor - INFO - 无GPU，使用CPU
2025-08-21 12:08:52 - src.model.lstm_lgbm_predictor - INFO - 训练LSTM模型...
2025-08-21 12:28:08 - __main__ - INFO - ====== 开始数据获取 ======
2025-08-21 12:28:08 - __main__ - INFO - 正常模式：使用10年数据
2025-08-21 12:28:08 - src.data_storage.data_saver - INFO - init saver, file path: ./data\stock_data.db
2025-08-21 12:28:08 - src.data_storage.data_saver - INFO - read stock_daily data from sqlite, sql command: select * from stock_daily where trade_date >= 20150823 and trade_date <= 20250820
2025-08-21 12:28:11 - __main__ - INFO - 获取数据完成: 20220104至20250819, 共691696条记录, 800支股票
2025-08-21 12:28:11 - __main__ - INFO - ====== 开始计算技术指标 ======
2025-08-21 12:28:21 - __main__ - INFO - 计算技术指标完成: 新增36个特征，总特征数=48
2025-08-21 12:28:21 - __main__ - INFO - 技术指标列表示例: ['trade_date', 'ts_code', 'open', 'close', 'high', 'low', 'volume', 'amount', 'amplitude', 'change', 'change_amount', 'turnover', 'MA5', 'MA10', 'MA20', 'RSI6', 'RSI12', 'MOM', 'KDJ_K', 'KDJ_D', 'KDJ_J', 'CCI', 'ADX', 'PLUS_DI', 'MINUS_DI', 'MACD', 'MACD_Signal', 'MACD_Hist', 'BB_upper', 'BB_middle', 'BB_lower', 'ATR', 'VOL_MA5', 'VOL_MA10', 'OBV', 'CMF', 'MFI', 'CDL_BULLISH_ENGULFING', 'CDL_HAMMER', 'CDL_DOJI', 'CDL_MORNINGSTAR', 'CDL_THREEWHITESOLDIERS', 'SAR', 'VWAP', 'StochRSI_K', 'StochRSI_D', 'price_momentum', 'volume_momentum']
2025-08-21 12:28:21 - __main__ - INFO - ====== 开始数据预处理 ======
2025-08-21 12:28:21 - __main__ - INFO - 数据质量检查...
2025-08-21 12:28:21 - src.data_preprocessing.data_preprocessor - INFO - 开始一站式数据准备和模型拟合...
2025-08-21 12:28:21 - src.data_preprocessing.data_preprocessor - INFO - 步骤1: 创建特征...
2025-08-21 12:28:21 - src.data_preprocessing.data_preprocessor - INFO - 开始创建特征，输入数据形状: (691696, 48)
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 数据排序完成，股票数量: 800
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 技术信号创建完成，新增特征数量: 1
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 步骤2: 创建目标变量...
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 开始创建目标变量，预测周期: 1
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 目标变量创建完成，有效样本数: 690896, 均值: 0.0002, 标准差: 0.0261
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 数据质量检查...
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - WARNING - 发现800个空值，将在预处理中处理
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 步骤3: 全局特征选择...
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 开始特征选择...
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 原始特征数量: 42
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 缺失值过滤后特征数量: 42 (过滤了 0 个)
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 开始多重共线性检测，输入特征数量: 42
2025-08-21 12:28:22 - src.data_preprocessing.data_preprocessor - INFO - 预过滤高相关特征: 19 个 (相关系数>0.8)
2025-08-21 12:28:25 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测完成: 最终选择 20 个特征
2025-08-21 12:28:25 - src.data_preprocessing.data_preprocessor - INFO - 特征数量限制: 从 20 个减少到 20 个
2025-08-21 12:28:25 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测后最终特征数量: 20
2025-08-21 12:28:25 - src.data_preprocessing.data_preprocessor - INFO - 特征选择完成: 原始42 → 缺失值过滤42 → 去多重共线性20
2025-08-21 12:28:25 - src.data_preprocessing.data_preprocessor - INFO - 步骤4: 收集时序数据...
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - 数据准备完成:
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - - 处理股票数: 800/800
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - - 总样本数: 674896
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - - 特征维度: 20
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - - 时间步长: 20
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - 开始模型拟合，计算预处理参数...
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - 开始拟合预处理器...
2025-08-21 12:34:19 - src.data_preprocessing.data_preprocessor - INFO - 训练数据形状: X=(674896, 20, 20), y=(674896,)
2025-08-21 12:34:21 - src.data_preprocessing.data_preprocessor - INFO - 计算缺失值填充值...
2025-08-21 12:34:27 - src.data_preprocessing.data_preprocessor - INFO - 缺失值统计: 总缺失值 0, 平均每特征 0.0
2025-08-21 12:34:27 - src.data_preprocessing.data_preprocessor - INFO - 计算异常值阈值...
2025-08-21 12:34:31 - src.data_preprocessing.data_preprocessor - INFO - 异常值统计: 总异常值 4133110, 平均每特征 206655.5
2025-08-21 12:34:31 - src.data_preprocessing.data_preprocessor - INFO - 开始数据清洗...
2025-08-21 12:34:36 - src.data_preprocessing.data_preprocessor - INFO - 处理目标变量...
2025-08-21 12:34:36 - src.data_preprocessing.data_preprocessor - INFO - 目标变量无需填充，均值: -0.0007
2025-08-21 12:34:36 - src.data_preprocessing.data_preprocessor - INFO - 计算目标变量异常值阈值...
2025-08-21 12:34:36 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值范围: [-0.0779, 0.0785]
2025-08-21 12:34:36 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值处理: 裁剪 12332/674896 个异常值
2025-08-21 12:34:36 - src.data_preprocessing.data_preprocessor - INFO - 拟合特征缩放器...
2025-08-21 12:34:42 - src.data_preprocessing.data_preprocessor - INFO - 拟合目标变量缩放器...
2025-08-21 12:34:42 - src.data_preprocessing.data_preprocessor - INFO - 模型拟合完成，所有预处理参数已计算
2025-08-21 12:34:43 - src.data_preprocessing.data_preprocessor - INFO - 转换数据...
2025-08-21 12:34:52 - src.data_preprocessing.data_preprocessor - INFO - 一站式处理完成: 获得674896个样本，674896支股票
2025-08-21 12:34:52 - src.data_preprocessing.data_preprocessor - INFO - 最终数据维度: X= (674896, 20, 20), y=(674896,)
2025-08-21 12:34:53 - __main__ - INFO - 数据预处理完成: 获得674896个样本，674896支股票
2025-08-21 12:34:53 - __main__ - INFO - 时序数据维度: X_sequence=(674896, 20, 20), y=(674896,)
2025-08-21 12:34:53 - __main__ - INFO - ====== 创建训练测试集 ======
2025-08-21 12:34:53 - src.data_preprocessing.data_preprocessor - INFO - Train/test split completed: 539916 train, 134980 test samples
2025-08-21 12:34:53 - __main__ - INFO - 数据分割完成:
2025-08-21 12:34:53 - __main__ - INFO -   训练集: 539916个样本 (80.0%)
2025-08-21 12:34:53 - __main__ - INFO -   测试集: 134980个样本 (20.0%)
2025-08-21 12:34:53 - __main__ - INFO - ====== 开始训练LSTM+LightGBM混合模型 ======
2025-08-21 12:34:53 - src.model.lstm_lgbm_predictor - INFO - 开始混合模型训练，样本数量: 539916
2025-08-21 12:34:53 - src.model.lstm_lgbm_predictor - INFO - 输入序列形状: (539916, 20, 20)
2025-08-21 12:34:58 - src.model.lstm_lgbm_predictor - INFO - 训练样本数过多 (539916)，子采样到 100000
2025-08-21 12:34:58 - src.model.lstm_lgbm_predictor - INFO - 子采样后样本数量: 100000
2025-08-21 12:34:58 - src.model.lstm_lgbm_predictor - INFO - 训练LightGBM模型...
2025-08-21 12:35:00 - src.model.lstm_lgbm_predictor - INFO - 可用内存: 6.70 GB
2025-08-21 12:35:01 - src.model.lstm_lgbm_predictor - INFO - 无GPU，使用CPU
2025-08-21 12:35:01 - src.model.lstm_lgbm_predictor - INFO - 训练LSTM模型...
2025-08-21 12:39:48 - __main__ - INFO - ====== 开始数据获取 ======
2025-08-21 12:39:48 - __main__ - INFO - 正常模式：使用10年数据
2025-08-21 12:39:48 - src.data_storage.data_saver - INFO - init saver, file path: ./data\stock_data.db
2025-08-21 12:39:48 - src.data_storage.data_saver - INFO - read stock_daily data from sqlite, sql command: select * from stock_daily where trade_date >= 20150823 and trade_date <= 20250820
2025-08-21 12:39:52 - __main__ - INFO - 获取数据完成: 20220104至20250819, 共691696条记录, 800支股票
2025-08-21 12:39:52 - __main__ - INFO - ====== 开始计算技术指标 ======
2025-08-21 12:40:06 - __main__ - INFO - 计算技术指标完成: 新增36个特征，总特征数=48
2025-08-21 12:40:06 - __main__ - INFO - 技术指标列表示例: ['trade_date', 'ts_code', 'open', 'close', 'high', 'low', 'volume', 'amount', 'amplitude', 'change', 'change_amount', 'turnover', 'MA5', 'MA10', 'MA20', 'RSI6', 'RSI12', 'MOM', 'KDJ_K', 'KDJ_D', 'KDJ_J', 'CCI', 'ADX', 'PLUS_DI', 'MINUS_DI', 'MACD', 'MACD_Signal', 'MACD_Hist', 'BB_upper', 'BB_middle', 'BB_lower', 'ATR', 'VOL_MA5', 'VOL_MA10', 'OBV', 'CMF', 'MFI', 'CDL_BULLISH_ENGULFING', 'CDL_HAMMER', 'CDL_DOJI', 'CDL_MORNINGSTAR', 'CDL_THREEWHITESOLDIERS', 'SAR', 'VWAP', 'StochRSI_K', 'StochRSI_D', 'price_momentum', 'volume_momentum']
2025-08-21 12:40:07 - __main__ - INFO - ====== 开始数据预处理 ======
2025-08-21 12:40:07 - __main__ - INFO - 数据质量检查...
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 开始一站式数据准备和模型拟合...
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 步骤1: 创建特征...
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 开始创建特征，输入数据形状: (691696, 48)
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 数据排序完成，股票数量: 800
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 技术信号创建完成，新增特征数量: 1
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 步骤2: 创建目标变量...
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 开始创建目标变量，预测周期: 1
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 目标变量创建完成，有效样本数: 690896, 均值: 0.0002, 标准差: 0.0261
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 数据质量检查...
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - WARNING - 发现800个空值，将在预处理中处理
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 步骤3: 全局特征选择...
2025-08-21 12:40:07 - src.data_preprocessing.data_preprocessor - INFO - 开始特征选择...
2025-08-21 12:40:08 - src.data_preprocessing.data_preprocessor - INFO - 原始特征数量: 42
2025-08-21 12:40:08 - src.data_preprocessing.data_preprocessor - INFO - 缺失值过滤后特征数量: 42 (过滤了 0 个)
2025-08-21 12:40:08 - src.data_preprocessing.data_preprocessor - INFO - 开始多重共线性检测，输入特征数量: 42
2025-08-21 12:40:08 - src.data_preprocessing.data_preprocessor - INFO - 预过滤高相关特征: 19 个 (相关系数>0.8)
2025-08-21 12:40:11 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测完成: 最终选择 20 个特征
2025-08-21 12:40:11 - src.data_preprocessing.data_preprocessor - INFO - 特征数量限制: 从 20 个减少到 20 个
2025-08-21 12:40:11 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测后最终特征数量: 20
2025-08-21 12:40:11 - src.data_preprocessing.data_preprocessor - INFO - 特征选择完成: 原始42 → 缺失值过滤42 → 去多重共线性20
2025-08-21 12:40:11 - src.data_preprocessing.data_preprocessor - INFO - 步骤4: 收集时序数据...
2025-08-21 12:46:30 - src.data_preprocessing.data_preprocessor - INFO - 数据准备完成:
2025-08-21 12:46:30 - src.data_preprocessing.data_preprocessor - INFO - - 处理股票数: 800/800
2025-08-21 12:46:30 - src.data_preprocessing.data_preprocessor - INFO - - 总样本数: 674896
2025-08-21 12:46:30 - src.data_preprocessing.data_preprocessor - INFO - - 特征维度: 20
2025-08-21 12:46:30 - src.data_preprocessing.data_preprocessor - INFO - - 时间步长: 20
2025-08-21 12:46:31 - src.data_preprocessing.data_preprocessor - INFO - 开始模型拟合，计算预处理参数...
2025-08-21 12:46:31 - src.data_preprocessing.data_preprocessor - INFO - 开始拟合预处理器...
2025-08-21 12:46:31 - src.data_preprocessing.data_preprocessor - INFO - 训练数据形状: X=(674896, 20, 20), y=(674896,)
2025-08-21 12:46:32 - src.data_preprocessing.data_preprocessor - INFO - 计算缺失值填充值...
2025-08-21 12:46:39 - src.data_preprocessing.data_preprocessor - INFO - 缺失值统计: 总缺失值 0, 平均每特征 0.0
2025-08-21 12:46:39 - src.data_preprocessing.data_preprocessor - INFO - 计算异常值阈值...
2025-08-21 12:46:42 - src.data_preprocessing.data_preprocessor - INFO - 异常值统计: 总异常值 4133110, 平均每特征 206655.5
2025-08-21 12:46:42 - src.data_preprocessing.data_preprocessor - INFO - 开始数据清洗...
2025-08-21 12:46:48 - src.data_preprocessing.data_preprocessor - INFO - 处理目标变量...
2025-08-21 12:46:48 - src.data_preprocessing.data_preprocessor - INFO - 目标变量无需填充，均值: -0.0007
2025-08-21 12:46:48 - src.data_preprocessing.data_preprocessor - INFO - 计算目标变量异常值阈值...
2025-08-21 12:46:48 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值范围: [-0.0779, 0.0785]
2025-08-21 12:46:48 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值处理: 裁剪 12332/674896 个异常值
2025-08-21 12:46:48 - src.data_preprocessing.data_preprocessor - INFO - 拟合特征缩放器...
2025-08-21 12:46:56 - src.data_preprocessing.data_preprocessor - INFO - 拟合目标变量缩放器...
2025-08-21 12:46:56 - src.data_preprocessing.data_preprocessor - INFO - 模型拟合完成，所有预处理参数已计算
2025-08-21 12:46:56 - src.data_preprocessing.data_preprocessor - INFO - 转换数据...
2025-08-21 12:47:07 - src.data_preprocessing.data_preprocessor - INFO - 一站式处理完成: 获得674896个样本，674896支股票
2025-08-21 12:47:07 - src.data_preprocessing.data_preprocessor - INFO - 最终数据维度: X= (674896, 20, 20), y=(674896,)
2025-08-21 12:47:07 - __main__ - INFO - 数据预处理完成: 获得674896个样本，674896支股票
2025-08-21 12:47:07 - __main__ - INFO - 时序数据维度: X_sequence=(674896, 20, 20), y=(674896,)
2025-08-21 12:47:07 - __main__ - INFO - ====== 创建训练测试集 ======
2025-08-21 12:47:07 - src.data_preprocessing.data_preprocessor - INFO - Train/test split completed: 539916 train, 134980 test samples
2025-08-21 12:47:07 - __main__ - INFO - 数据分割完成:
2025-08-21 12:47:07 - __main__ - INFO -   训练集: 539916个样本 (80.0%)
2025-08-21 12:47:07 - __main__ - INFO -   测试集: 134980个样本 (20.0%)
2025-08-21 12:47:07 - __main__ - INFO - ====== 开始训练LSTM+LightGBM混合模型 ======
2025-08-21 12:47:07 - src.model.lstm_lgbm_predictor - INFO - 开始混合模型训练，样本数量: 539916
2025-08-21 12:47:07 - src.model.lstm_lgbm_predictor - INFO - 输入序列形状: (539916, 20, 20)
2025-08-21 12:47:12 - src.model.lstm_lgbm_predictor - INFO - 训练LightGBM模型...
2025-08-21 12:47:20 - src.model.lstm_lgbm_predictor - INFO - 可用内存: 6.55 GB
2025-08-21 12:47:20 - src.model.lstm_lgbm_predictor - INFO - 无GPU，使用CPU
2025-08-21 12:47:20 - src.model.lstm_lgbm_predictor - INFO - 训练LSTM模型...
2025-08-21 16:35:22 - __main__ - ERROR - 系统执行失败: This optimizer was created with a `LearningRateSchedule` object as its `learning_rate` constructor argument, hence its learning rate is not settable. If you need the learning rate to be settable, you should instantiate the optimizer with a float `learning_rate` argument.
Traceback (most recent call last):
  File "d:\Projects\stock_selection\main.py", line 114, in main
    training_results = model.fit(
  File "d:\Projects\stock_selection\src\model\lstm_lgbm_predictor.py", line 189, in fit
    history = self.lstm_model.fit(
  File "D:\Projects\stock_selection\.venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "D:\Projects\stock_selection\.venv\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 717, in learning_rate
    raise TypeError(
TypeError: This optimizer was created with a `LearningRateSchedule` object as its `learning_rate` constructor argument, hence its learning rate is not settable. If you need the learning rate to be settable, you should instantiate the optimizer with a float `learning_rate` argument.
2025-08-21 16:50:12 - __main__ - INFO - ====== 开始数据获取 ======
2025-08-21 16:50:12 - __main__ - INFO - 正常模式：使用10年数据
2025-08-21 16:50:12 - src.data_storage.data_saver - INFO - init saver, file path: ./data\stock_data.db
2025-08-21 16:50:12 - src.data_storage.data_saver - INFO - read stock_daily data from sqlite, sql command: select * from stock_daily where trade_date >= 20150823 and trade_date <= 20250820
2025-08-21 16:50:16 - __main__ - INFO - 获取数据完成: 20220104至20250819, 共691696条记录, 800支股票
2025-08-21 16:50:16 - __main__ - INFO - ====== 开始计算技术指标 ======
2025-08-21 16:50:32 - __main__ - INFO - 计算技术指标完成: 新增36个特征，总特征数=48
2025-08-21 16:50:32 - __main__ - INFO - 技术指标列表示例: ['trade_date', 'ts_code', 'open', 'close', 'high', 'low', 'volume', 'amount', 'amplitude', 'change', 'change_amount', 'turnover', 'MA5', 'MA10', 'MA20', 'RSI6', 'RSI12', 'MOM', 'KDJ_K', 'KDJ_D', 'KDJ_J', 'CCI', 'ADX', 'PLUS_DI', 'MINUS_DI', 'MACD', 'MACD_Signal', 'MACD_Hist', 'BB_upper', 'BB_middle', 'BB_lower', 'ATR', 'VOL_MA5', 'VOL_MA10', 'OBV', 'CMF', 'MFI', 'CDL_BULLISH_ENGULFING', 'CDL_HAMMER', 'CDL_DOJI', 'CDL_MORNINGSTAR', 'CDL_THREEWHITESOLDIERS', 'SAR', 'VWAP', 'StochRSI_K', 'StochRSI_D', 'price_momentum', 'volume_momentum']
2025-08-21 16:50:32 - __main__ - INFO - ====== 开始数据预处理 ======
2025-08-21 16:50:32 - __main__ - INFO - 数据质量检查...
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 开始一站式数据准备和模型拟合...
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 步骤1: 创建特征...
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 开始创建特征，输入数据形状: (691696, 48)
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 数据排序完成，股票数量: 800
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 技术信号创建完成，新增特征数量: 1
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 步骤2: 创建目标变量...
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 开始创建目标变量，预测周期: 1
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 目标变量创建完成，有效样本数: 690896, 均值: 0.0002, 标准差: 0.0261
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 数据质量检查...
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - WARNING - 发现800个空值，将在预处理中处理
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 步骤3: 全局特征选择...
2025-08-21 16:50:33 - src.data_preprocessing.data_preprocessor - INFO - 开始特征选择...
2025-08-21 16:50:34 - src.data_preprocessing.data_preprocessor - INFO - 原始特征数量: 42
2025-08-21 16:50:34 - src.data_preprocessing.data_preprocessor - INFO - 缺失值过滤后特征数量: 42 (过滤了 0 个)
2025-08-21 16:50:34 - src.data_preprocessing.data_preprocessor - INFO - 开始多重共线性检测，输入特征数量: 42
2025-08-21 16:50:34 - src.data_preprocessing.data_preprocessor - INFO - 预过滤高相关特征: 19 个 (相关系数>0.8)
2025-08-21 16:50:36 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测完成: 最终选择 20 个特征
2025-08-21 16:50:36 - src.data_preprocessing.data_preprocessor - INFO - 特征数量限制: 从 20 个减少到 20 个
2025-08-21 16:50:36 - src.data_preprocessing.data_preprocessor - INFO - 多重共线性检测后最终特征数量: 20
2025-08-21 16:50:36 - src.data_preprocessing.data_preprocessor - INFO - 特征选择完成: 原始42 → 缺失值过滤42 → 去多重共线性20
2025-08-21 16:50:36 - src.data_preprocessing.data_preprocessor - INFO - 步骤4: 收集时序数据...
2025-08-21 17:00:07 - src.data_preprocessing.data_preprocessor - INFO - 数据准备完成:
2025-08-21 17:00:07 - src.data_preprocessing.data_preprocessor - INFO - - 处理股票数: 800/800
2025-08-21 17:00:07 - src.data_preprocessing.data_preprocessor - INFO - - 总样本数: 674896
2025-08-21 17:00:07 - src.data_preprocessing.data_preprocessor - INFO - - 特征维度: 20
2025-08-21 17:00:07 - src.data_preprocessing.data_preprocessor - INFO - - 时间步长: 20
2025-08-21 17:00:14 - src.data_preprocessing.data_preprocessor - INFO - 开始模型拟合，计算预处理参数...
2025-08-21 17:00:14 - src.data_preprocessing.data_preprocessor - INFO - 开始拟合预处理器...
2025-08-21 17:00:14 - src.data_preprocessing.data_preprocessor - INFO - 训练数据形状: X=(674896, 20, 20), y=(674896,)
2025-08-21 17:00:23 - src.data_preprocessing.data_preprocessor - INFO - 计算缺失值填充值...
2025-08-21 17:00:29 - src.data_preprocessing.data_preprocessor - INFO - 缺失值统计: 总缺失值 0, 平均每特征 0.0
2025-08-21 17:00:29 - src.data_preprocessing.data_preprocessor - INFO - 计算异常值阈值...
2025-08-21 17:00:34 - src.data_preprocessing.data_preprocessor - INFO - 异常值统计: 总异常值 4133110, 平均每特征 206655.5
2025-08-21 17:00:34 - src.data_preprocessing.data_preprocessor - INFO - 开始数据清洗...
2025-08-21 17:00:41 - src.data_preprocessing.data_preprocessor - INFO - 处理目标变量...
2025-08-21 17:00:41 - src.data_preprocessing.data_preprocessor - INFO - 目标变量无需填充，均值: -0.0007
2025-08-21 17:00:41 - src.data_preprocessing.data_preprocessor - INFO - 计算目标变量异常值阈值...
2025-08-21 17:00:41 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值范围: [-0.0779, 0.0785]
2025-08-21 17:00:41 - src.data_preprocessing.data_preprocessor - INFO - 目标变量异常值处理: 裁剪 12332/674896 个异常值
2025-08-21 17:00:41 - src.data_preprocessing.data_preprocessor - INFO - 拟合特征缩放器...
2025-08-21 17:00:46 - src.data_preprocessing.data_preprocessor - INFO - 拟合目标变量缩放器...
2025-08-21 17:00:46 - src.data_preprocessing.data_preprocessor - INFO - 模型拟合完成，所有预处理参数已计算
2025-08-21 17:00:46 - src.data_preprocessing.data_preprocessor - INFO - 转换数据...
2025-08-21 17:00:57 - src.data_preprocessing.data_preprocessor - INFO - 一站式处理完成: 获得674896个样本，674896支股票
2025-08-21 17:00:57 - src.data_preprocessing.data_preprocessor - INFO - 最终数据维度: X= (674896, 20, 20), y=(674896,)
2025-08-21 17:00:58 - __main__ - INFO - 数据预处理完成: 获得674896个样本，674896支股票
2025-08-21 17:00:58 - __main__ - INFO - 时序数据维度: X_sequence=(674896, 20, 20), y=(674896,)
2025-08-21 17:00:58 - __main__ - INFO - ====== 创建训练测试集 ======
2025-08-21 17:00:58 - src.data_preprocessing.data_preprocessor - INFO - Train/test split completed: 539916 train, 134980 test samples
2025-08-21 17:00:58 - __main__ - INFO - 数据分割完成:
2025-08-21 17:00:58 - __main__ - INFO -   训练集: 539916个样本 (80.0%)
2025-08-21 17:00:58 - __main__ - INFO -   测试集: 134980个样本 (20.0%)
2025-08-21 17:00:58 - __main__ - INFO - ====== 开始训练LSTM+LightGBM混合模型 ======
2025-08-21 17:00:58 - src.model.lstm_lgbm_predictor - INFO - 开始混合模型训练，样本数量: 539916
2025-08-21 17:00:58 - src.model.lstm_lgbm_predictor - INFO - 输入序列形状: (539916, 20, 20)
2025-08-21 17:01:04 - src.model.lstm_lgbm_predictor - INFO - 训练LightGBM模型...
2025-08-21 17:01:32 - src.model.lstm_lgbm_predictor - INFO - 可用内存: 4.29 GB
2025-08-21 17:01:32 - src.model.lstm_lgbm_predictor - INFO - 无GPU，使用CPU
2025-08-21 17:01:32 - src.model.lstm_lgbm_predictor - INFO - 训练LSTM模型...
